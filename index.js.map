{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\nconst API_KEY=\"53351360-25752520852e3bd129b79410f\";\n\nexport function getImagesByQuery(query,page=1,perPage=15){\nreturn axios.get(\"\",{params:{\n  key:API_KEY,\n  q:query,\n  image_type: \"photo\",\n  orientation: \"horizontal\",\n  safesearch: true,\n  page,\n  per_page:perPage,\n},})\n  .then(response=>{\n    if (!response.data || response.data.hits.length === 0) {\n  iziToast.warning({\n    message: 'На жаль, за вашим запитом зображень не знайдено. Спробуйте ще раз!',\n    position: 'topRight',\n  });\n  return { hits: [] };\n}\n\n      return response.data;\n    })\n\n    .catch(err => {console.error(err);\n    return { hits: [] }})}","import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nlet lightboxInstance = null; \n\nfunction initLightbox(selector = '.gallery a') {\n\n  if (lightboxInstance) return;\n  lightboxInstance = new SimpleLightbox(selector, {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\n\nfunction refreshLightbox() {\n  if (!lightboxInstance) {\n    initLightbox();\n  } else {\n    lightboxInstance.refresh();\n  }\n}\n\nexport function destroyLightbox() {\n  if (lightboxInstance) {\n    lightboxInstance.destroy();\n    lightboxInstance = null;\n  }\n}\n\n\nexport function createGallery(images, galleryEl) {\n  if (!images || images.length === 0) return Promise.resolve();\n\n  const galleryObj = images.map(image => ({\n    webformatURL: image.webformatURL,\n    largeImageURL: image.largeImageURL,\n    alt: image.tags,\n    likes: image.likes,\n    views: image.views,\n    comments: image.comments,\n    downloads: image.downloads,\n  }));\n\n  const markup = galleryObj\n    .map(\n      img => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n          <img \n            class=\"gallery-image\"\n            src=\"${img.webformatURL}\"\n            alt=\"${img.alt}\"\n          />\n        </a>\n        <div class=\"gallery-image-info\">\n          <p>Likes: ${img.likes}</p>\n          <p>Views: ${img.views}</p>\n          <p>Comments: ${img.comments}</p>\n          <p>Downloads: ${img.downloads}</p>\n        </div>\n      </li>\n      `\n    )\n    .join('');\n\n   \n  const loaderEl = galleryEl.querySelector('.loader-wrapper');\n\n  \n  loaderEl.insertAdjacentHTML('beforebegin', markup);\n\n    const newImages = Array.from(\n    galleryEl.querySelectorAll('li.gallery-item img')\n  ).slice(-images.length);\n\n  return Promise.all(\n    newImages.map(img =>\n      new Promise(resolve => {\n        if (img.complete) resolve();\n        img.onload = img.onerror = resolve;\n      })\n    )\n  ).then(() => {\n   \n    refreshLightbox();\n  });\n}\n\nexport function clearGallery(galleryEl) {\n  galleryEl.innerHTML = `\n    <li class=\"loader-wrapper hidden\">\n      <span class=\"loader\"></span>\n    </li>`;\n  destroyLightbox(); // important!\n}\n\nexport function showLoader(loaderEl) {\n  loaderEl?.classList.remove(\"hidden\");\n}\n\nexport function hideLoader(loaderEl) {\n  loaderEl?.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton(btn) {\n  btn?.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton(btn) {\n  btn?.classList.add(\"hidden\");\n}","import {getImagesByQuery} from './js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\n// import axios from \"axios\";\n\nimport iziToast from \"izitoast\";\n\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n// refs\nexport const refs={\n  form: document.querySelector('.form'),\n  gallery:document.querySelector('.gallery'),\n  loader: document.querySelector('.loader-wrapper'),\n  galleryBtn: document.querySelector('.gallery-btn')\n}\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst perPage = 15; \nlet totalPages = 0;\n\n async function onFormSubmit(event){\nevent.preventDefault();\n \nconst query = event.target.elements[\"search-text\"]?.value.trim();\nif (!query) return;\n\ncurrentQuery = query;\n  currentPage = 1;\n\n clearGallery(refs.gallery);\n hideLoadMoreButton(refs.galleryBtn);\n showLoader(refs.loader);\n\n try{ \n  const data =await getImagesByQuery(currentQuery, currentPage, perPage);\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.warning({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;}\n    \n    totalPages=Math.ceil(data.totalHits / perPage);\n\n    await createGallery(data.hits, refs.gallery); \n    if (currentPage < totalPages) {\n      showLoadMoreButton(refs.galleryBtn);\n    }\n    \n  }catch (err) {\n    console.error(err);\n  }finally {\n    hideLoader(refs.loader);}\n \n}\n\n\nasync function onLoadMoreClick(event){\n  currentPage++; \n\n  hideLoadMoreButton(refs.galleryBtn);\n  showLoader(refs.loader);\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage, perPage);\n\n    await createGallery(data.hits, refs.gallery);\nconst firstCard = refs.gallery.querySelector('li');\n    const cardHeight = firstCard ? firstCard.getBoundingClientRect().height : 0;\n\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth'\n    });\n\n\n    if (currentPage >= totalPages) {\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\", position: \"topRight\" });\n      hideLoadMoreButton(refs.galleryBtn);\n    } else {\n      showLoadMoreButton(refs.galleryBtn);\n    }\n\n  } catch (err) {\n    console.error(err);\n  } finally {\n    hideLoader(refs.loader);\n  }}\n\n// listener\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.galleryBtn.addEventListener('click', onLoadMoreClick)"],"names":["axios","API_KEY","getImagesByQuery","query","page","perPage","response","iziToast","err","lightboxInstance","initLightbox","selector","SimpleLightbox","refreshLightbox","destroyLightbox","createGallery","images","galleryEl","markup","image","img","newImages","resolve","clearGallery","showLoader","loaderEl","hideLoader","showLoadMoreButton","btn","hideLoadMoreButton","refs","currentQuery","currentPage","totalPages","onFormSubmit","event","_a","data","onLoadMoreClick","firstCard","cardHeight"],"mappings":"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"}