{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\nconst API_KEY = \"53351360-25752520852e3bd129b79410f\";\n\nexport async function getImagesByQuery(query, page = 1, perPage = 15) {\ntry {\nconst response = await axios.get(\"\", {\nparams: {\nkey: API_KEY,\nq: query,\nimage_type: \"photo\",\norientation: \"horizontal\",\nsafesearch: true,\npage,\nper_page: perPage,\n},\n});\n\nif (!response.data || !response.data.hits || response.data.hits.length === 0) {\n  return { hits: [], totalHits: 0 };\n}\n\nreturn {\n  hits: response.data.hits,\n  totalHits: response.data.totalHits,\n};\n\n} catch (err) {\nconsole.error(err);\nreturn { hits: [], totalHits: 0 };\n}\n}","import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nlet lightboxInstance = null; \n\nfunction initLightbox(selector = '.gallery a') {\n\n  if (lightboxInstance) return;\n  lightboxInstance = new SimpleLightbox(selector, {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\n\nfunction refreshLightbox() {\nif (!lightboxInstance) initLightbox();\nelse lightboxInstance.refresh();\n}\n\nexport function destroyLightbox() {\n  if (lightboxInstance) {\n    lightboxInstance.destroy();\n    lightboxInstance = null;\n  }\n}\n\n\nexport function createGallery(images, galleryEl) {\n  if (!images || images.length === 0) return Promise.resolve();\n\n  const galleryObj = images.map(image => ({\n    webformatURL: image.webformatURL,\n    largeImageURL: image.largeImageURL,\n    alt: image.tags,\n    likes: image.likes,\n    views: image.views,\n    comments: image.comments,\n    downloads: image.downloads,\n  }));\n\n  const markup = galleryObj\n    .map(\n      img => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n          <img \n            class=\"gallery-image\"\n            src=\"${img.webformatURL}\"\n            alt=\"${img.alt}\"\n          />\n        </a>\n        <div class=\"gallery-image-info\">\n          <p>Likes: ${img.likes}</p>\n          <p>Views: ${img.views}</p>\n          <p>Comments: ${img.comments}</p>\n          <p>Downloads: ${img.downloads}</p>\n        </div>\n      </li>\n      `\n    )\n    .join('');\n\n   \n  const loaderEl = galleryEl.querySelector('.loader-wrapper');\n\n  if (loaderEl) {\nloaderEl.insertAdjacentHTML('beforebegin', markup);\n} else {\ngalleryEl.insertAdjacentHTML('beforeend', markup);\n}\n\n\n    const newImages = Array.from(\n    galleryEl.querySelectorAll('li.gallery-item img')\n  ).slice(-images.length);\n\n  return Promise.all(\n    newImages.map(img =>\n      new Promise(resolve => {\n        if (img.complete) resolve();\n        img.onload = img.onerror = resolve;\n      })\n    )\n  ).then(() => {\n   \n    refreshLightbox();\n  });\n}\n\nexport function clearGallery(galleryEl) {\n  galleryEl.innerHTML = `\n    <li class=\"loader-wrapper hidden\">\n      <span class=\"loader\"></span>\n    </li>`;\n  destroyLightbox(); \n}\n\nexport function showLoader() {\nconst loader = document.querySelector('.loader-wrapper');\nif (loader) loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\nconst loader = document.querySelector('.loader-wrapper');\nif (loader) loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton(btn) {\nif (btn) btn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton(btn) {\nif (btn) btn.classList.add('hidden');\n}","import {getImagesByQuery} from './js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\n// import axios from \"axios\";\n\nimport iziToast from \"izitoast\";\n\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n// refs\nexport const refs={\n  form: document.querySelector('.form'),\n  gallery:document.querySelector('.gallery'),\n  loader: document.querySelector('.loader-wrapper'),\n  galleryBtn: document.querySelector('.gallery-btn')\n}\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst perPage = 15; \nlet totalPages = 0;\nlet endMessageShown = false;\n\n async function onFormSubmit(event){\nevent.preventDefault();\n \nconst query = event.target.elements[\"search-text\"]?.value.trim();\nif (!query) {\n  iziToast.warning({\n    message: \"Please enter a search query.\",\n    position: \"topRight\",\n  });\n  return;\n}\n\ncurrentQuery = query;\ncurrentPage = 1;\nendMessageShown = false;\n\n clearGallery(refs.gallery);\n hideLoadMoreButton(refs.galleryBtn);\n showLoader(refs.loader);\n\n try{ \n  const data =await getImagesByQuery(currentQuery, currentPage, perPage);\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.warning({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;}\n    \n    totalPages=Math.ceil(data.totalHits / perPage);\n\n    await createGallery(data.hits, refs.gallery); \n\n    if (currentPage < totalPages) {\n      showLoadMoreButton(refs.galleryBtn);\n    }\n    \n  }catch (err) {\n    console.error(err);\n  }finally {\n    hideLoader(refs.loader);}\n \n}\n\n\nasync function onLoadMoreClick(event){\n  currentPage++; \n\n  hideLoadMoreButton(refs.galleryBtn);\n  showLoader(refs.loader);\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage, perPage);\n\n    await createGallery(data.hits, refs.gallery);\n\nconst firstCard = refs.gallery.querySelector('li');\n    const cardHeight = firstCard ? firstCard.getBoundingClientRect().height : 0;\n\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth'\n    });\n\n\n    if (currentPage >= totalPages) {\n\n  if (!endMessageShown) {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: \"topRight\"\n    });\n    endMessageShown = true;\n  }\n\n  hideLoadMoreButton(refs.galleryBtn);  \n\n} else {\n  showLoadMoreButton(refs.galleryBtn);\n}\n\n  } catch (err) {\n    console.error(err);\n  } finally {\n    hideLoader(refs.loader);\n  }}\n\n// listener\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.galleryBtn.addEventListener('click', onLoadMoreClick)"],"names":["axios","API_KEY","getImagesByQuery","query","page","perPage","response","err","lightboxInstance","initLightbox","selector","SimpleLightbox","refreshLightbox","destroyLightbox","createGallery","images","galleryEl","markup","image","img","loaderEl","newImages","resolve","clearGallery","showLoader","loader","hideLoader","showLoadMoreButton","btn","hideLoadMoreButton","refs","currentQuery","currentPage","totalPages","endMessageShown","onFormSubmit","event","_a","iziToast","data","onLoadMoreClick","firstCard","cardHeight"],"mappings":"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"}